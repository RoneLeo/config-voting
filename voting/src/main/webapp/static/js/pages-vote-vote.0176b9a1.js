(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-vote-vote"],{"17b5":function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=a(e("7e6b"));function a(t){return t&&t.__esModule?t:{default:t}}var n={data:function(){return{hdid:null,user:{},myJson:s.default,activity:{},isBack:!1,current:1,curTime:"",strTime:"",endTime:"",res:[],inputRes:[],saved:!1}},mounted:function(){},onLoad:function(t){this.hdid=t.hdid,this.user=this.getGlobalUser()||{},getCurrentPages().length>1&&(this.isBack=!0),this.hdid&&this.getData()},onShow:function(){this.user=this.getGlobalUser()||{}},computed:{logined:function(){return this.$store.state.logined}},watch:{logined:{handler:function(t,i){this.user=this.getGlobalUser()||{},t&&this.getData()},immediate:!0}},methods:{inputChange:function(t){var i=t.currentTarget.dataset,e=i.index,s=i.opid,a=t.target.value;this.inputRes[e]={oid:s,pid:this.user.id,qid:this.activity.votelist[e].id,bz:a}},createCode:function(){var t=this;this.$api.post("/theme/updateFbzt",{id:this.hdid,fbzt:1}).then(function(i){200==i.resCode?(uni.showToast({title:"发布成功！",icon:"none"}),t.gotoCodePage()):uni.showToast({title:"操作失败！",icon:"none"})})},gotoCountPage:function(){uni.navigateTo({url:"../../pages/voteCount/voteCount?hdid="+this.hdid})},gotoCodePage:function(){uni.navigateTo({url:"../../pages/code/code?lx=vote&id="+this.hdid+"&title="+this.activity.bt+"&kssj="+this.activity.kssj.substring(0,11)+"&jssj="+this.activity.jssj.substring(0,11)})},getData:function(){var t=this;uni.showLoading({title:"加载中"}),this.$api.post("/theme/findAllInfoById",{id:this.hdid}).then(function(i){uni.hideLoading(),200==i.resCode&&(t.activity=i.data,t.res=new Array(t.activity.votelist.length),t.inputRes=new Array(t.activity.votelist.length),t.curTime=(new Date).getTime(),t.strTime=new Date(Date.parse(t.activity.kssj.replace(/-/g,"/"))).getTime(),t.endTime=new Date(Date.parse(t.activity.jssj.replace(/-/g,"/"))).getTime())})},updateFbzt:function(t){this.$api.post("/theme/updateFbzt",{id:this.hdid,fbzt:t}).then(function(t){200==t.resCode?(uni.showToast({title:"操作成功！",icon:"none"}),uni.navigateBack()):uni.showToast({title:"操作失败！",icon:"none"})})},saveRes:function(){var t=this,i=this.activity.votelist.length;if("2"!=this.activity.votelist[i-1].tplx||!this.activity.votelist[i-1].zxs||this.res[i-1].length>=this.activity.votelist[i-1].zxs&&this.res[i-1].length<=this.activity.votelist[i-1].zds){for(var e=[],s=0,a=this.res.length;s<a;s++)if(this.res[s]&&this.res[s].length)for(var n=0;n<this.res[s].length;n++)this.res[s][n]&&this.inputRes[s]&&this.res[s][n].oid==this.inputRes[s].oid&&this.res[s][n].pid==this.inputRes[s].pid&&this.res[s][n].qid==this.inputRes[s].qid?e.push(this.inputRes[s]):e.push(this.res[s][n]);this.$api.post("/voting/vote",JSON.stringify(e)).then(function(i){200==i.resCode?(uni.showToast({title:"保存成功！",icon:"none"}),t.saved=!0,uni.navigateBack()):uni.showToast({title:"保存失败！",icon:"none"})})}else uni.showToast({title:"请确认你的选择是否符合题目要求",icon:"none"})},radioChange:function(t){var i=this,e="radio"+t;this.res[t]=[];var s=this.$refs[e][0].radioList.length&&this.$refs[e][0].radioList;s.forEach(function(e){if(e.radioChecked){var s={pid:i.user.id,qid:i.activity.votelist[t].id,oid:e.radioValue,bz:""};i.res[t].push(s)}})},checkboxChange:function(t){var i=this,e="checkbox"+t;this.res[t]=[];var s=this.$refs[e][0].checkboxList.length&&this.$refs[e][0].checkboxList;s.forEach(function(e){if(e.checkboxChecked){var s={pid:i.user.id,qid:i.activity.votelist[t].id,oid:e.checkboxValue,bz:""};i.res[t].push(s)}})},lastOne:function(){this.current>1&&this.current--},nextOne:function(){var t=this.current-1;this.current<this.activity.votelist.length&&("2"==this.activity.votelist[t].tplx?this.activity.votelist[t].zxs?this.res[t]&&this.res[t].length&&this.res[t].length>=this.activity.votelist[t].zxs&&this.res[t].length<=this.activity.votelist[t].zds?this.current++:uni.showToast({title:"请确认你的选择是否符合题目要求",icon:"none"}):this.current++:this.res[t]&&this.res[t].length&&1==this.res[t].length?this.current++:uni.showToast({title:"请确认你的选择是否符合题目要求",icon:"none"}))},gotoVoteTitle:function(){uni.navigateTo({url:"../../pages/voteTitle/voteTitle"})},SwitchB:function(t){this.switchB=t.detail.value},startDateChange:function(t){this.startDate=t.detail.value},endDateChange:function(t){this.endDate=t.detail.value}}};i.default=n},4355:function(t,i,e){"use strict";var s=e("e678"),a=e.n(s);a.a},7279:function(t,i,e){"use strict";e.r(i);var s=e("ca81"),a=e("c81b");for(var n in a)"default"!==n&&function(t){e.d(i,t,function(){return a[t]})}(n);e("4355");var o=e("2877"),r=Object(o["a"])(a["default"],s["a"],s["b"],!1,null,"d1790158",null);i["default"]=r.exports},"7e6b":function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s={1:"文字",2:"多媒体",3:"数字",4:"其他"},a={1:"单选",2:"多选"},n={voteOpt:s,vote:a};i.default=n},c81b:function(t,i,e){"use strict";e.r(i);var s=e("17b5"),a=e.n(s);for(var n in s)"default"!==n&&function(t){e.d(i,t,function(){return s[t]})}(n);i["default"]=a.a},ca81:function(t,i,e){"use strict";var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{staticClass:"page"},[e("login"),e("cu-custom",{directives:[{name:"show",rawName:"v-show",value:t.isBack,expression:"isBack"}],attrs:{bgColor:"bg-blue",isBack:t.isBack}},[e("template",{staticStyle:{width:"calc(100% - 100px)"},attrs:{slot:"content"},slot:"content"},[t._v(t._s(t.activity&&t.activity.bt))])],2),e("v-uni-view",{staticClass:"vote-wrapper padding"},[e("v-uni-image",{directives:[{name:"show",rawName:"v-show",value:"2"==t.activity.sffb,expression:"activity.sffb == '2'"}],staticStyle:{width:"150upx",height:"150upx",position:"absolute",left:"480upx",top:"140upx"},attrs:{src:"../../static/img/end.png",mode:""}}),e("v-uni-view",{staticClass:"vote-tt title",staticStyle:{"font-size":"18px"}},[t._v(t._s(t.activity.bt)),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"1"==t.activity.tpzt||t.saved,expression:"activity.tpzt == '1' || saved"}],staticClass:"cu-tag line-orange radius",staticStyle:{"margin-left":"20upx"}},[t._v("已完成投票")])],1),e("v-uni-view",{staticClass:"vote-tt",staticStyle:{"margin-top":"40upx"}},[t._v("活动状态："),e("v-uni-text",{staticClass:"vote-subtt"},[t._v(t._s("0"==t.activity.sffb?"尚未发布":"1"==t.activity.sffb?"已发布":"活动已结束"))])],1),e("v-uni-view",{staticClass:"vote-tt"},[t._v("投票期限："),e("v-uni-text",{staticClass:"vote-subtt"},[t._v(t._s(t.activity.kssj&&t.activity.kssj.substring(0,11))+" 至 "+t._s(t.activity.kssj&&t.activity.jssj.substring(0,11)))])],1),e("v-uni-view",{staticClass:"vote-tt"},[t._v("投票说明："),e("v-uni-text",{staticClass:"vote-subtt"},[t._v(t._s(t.activity.nr))])],1),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"2"!=t.activity.sffb,expression:"activity.sffb != '2'"}],staticClass:"scroll-wrapper",staticStyle:{padding:"30upx 0"}},[t._l(t.activity.votelist,function(i,s){return e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.current==s+1,expression:"current == (index + 1)"}],staticClass:"scroll-view-item",attrs:{id:"item"+(s+1)}},[e("v-uni-view",{staticClass:"item-block"},[e("v-uni-view",{staticClass:"item-tt"},[e("v-uni-view",{staticClass:"cu-tag radius bg-blue",staticStyle:{"margin-right":"20upx"}},[t._v(t._s(t.myJson.vote[i.tplx]))]),t._v(t._s(i.bt)),e("v-uni-text",{directives:[{name:"show",rawName:"v-show",value:"2"==i.tplx,expression:"vote.tplx=='2'"}]},[t._v("（选择"+t._s(i.zxs)+"~"+t._s(i.zds)+"）")])],1),e("v-uni-view",{staticClass:"item-td padding-sm"},[e("v-uni-radio-group",{directives:[{name:"show",rawName:"v-show",value:"1"==i.tplx,expression:"vote.tplx == '1'"}],ref:"radio"+s,refInFor:!0,staticStyle:{"margin-left":"30upx",width:"90%"},on:{change:function(i){i=t.$handleEvent(i),t.radioChange(s)}}},t._l(i.volist,function(i,a){return e("v-uni-label",{key:a},[e("v-uni-radio",{attrs:{value:i.id+""}}),e("v-uni-view",{staticClass:"label-text"},[e("v-uni-text",{directives:[{name:"show",rawName:"v-show",value:1==i.xxlx||3==i.xxlx,expression:"opt.xxlx == 1 || opt.xxlx == 3"}]},[t._v(t._s(i.xxmc))]),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:2==i.xxlx,expression:"opt.xxlx == 2"}]},[e("v-uni-image",{staticStyle:{width:"200upx",height:"150upx"},attrs:{src:i.xxmc,mode:""}})],1),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:4==i.xxlx,expression:"opt.xxlx == 4"}],staticStyle:{border:"1px solid #e1e1e1","border-radius":"10upx"}},[e("v-uni-input",{ref:"input"+s,refInFor:!0,staticStyle:{"padding-left":"20upx"},attrs:{"data-index":s,"data-opid":i.id,placeholder:"请填写"},on:{input:function(i){i=t.$handleEvent(i),t.inputChange(i)}}})],1),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:""!=i.xxnr&&null!=i.xxnr,expression:"opt.xxnr!=''&&opt.xxnr!=null"}],staticClass:"detail"},[t._v("详情")])],1)],1)})),e("v-uni-checkbox-group",{directives:[{name:"show",rawName:"v-show",value:"2"==i.tplx,expression:"vote.tplx == '2'"}],ref:"checkbox"+s,refInFor:!0,staticStyle:{"margin-left":"30upx",width:"90%"},on:{change:function(i){i=t.$handleEvent(i),t.checkboxChange(s)}}},t._l(i.volist,function(i,a){return e("v-uni-label",{key:a},[e("v-uni-checkbox",{attrs:{value:i.id+""}}),e("v-uni-view",{staticClass:"label-text"},[e("v-uni-text",{directives:[{name:"show",rawName:"v-show",value:1==i.xxlx||3==i.xxlx,expression:"opt.xxlx == 1 || opt.xxlx == 3"}]},[t._v(t._s(i.xxmc))]),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:2==i.xxlx,expression:"opt.xxlx == 2"}]},[e("v-uni-image",{staticStyle:{width:"200upx",height:"150upx"},attrs:{src:i.xxmc,mode:""}})],1),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:4==i.xxlx,expression:"opt.xxlx == 4"}],staticStyle:{border:"1px solid #e1e1e1","border-radius":"10upx"}},[e("v-uni-input",{ref:"input"+s,refInFor:!0,staticStyle:{"padding-left":"20upx"},attrs:{"data-index":s,"data-opid":i.id,placeholder:"请填写"},on:{input:function(i){i=t.$handleEvent(i),t.inputChange(i)}}})],1),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:""!=i.xxnr&&null!=i.xxnr,expression:"opt.xxnr!=''&&opt.xxnr!=null"}],staticClass:"detail"},[t._v("详情")])],1)],1)}))],1)],1)],1)}),e("v-uni-view",{staticClass:"pages padding justify-center"},[e("v-uni-button",{staticClass:"cu-btn bg-blue",on:{click:function(i){i=t.$handleEvent(i),t.lastOne(i)}}},[t._v("上一题")]),e("v-uni-text",{staticStyle:{width:"130upx","text-align":"center",display:"inline-block","align-self":"center"}},[t._v(t._s(t.current)+" / "+t._s(t.activity.votelist&&t.activity.votelist.length))]),e("v-uni-button",{staticClass:"cu-btn bg-blue",on:{click:function(i){i=t.$handleEvent(i),t.nextOne(i)}}},[t._v("下一题")])],1),e("v-uni-view",{staticStyle:{"margin-top":"50upx"}},[e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"1"==t.user.js&&"0"==t.activity.sffb,expression:"user.js == '1' && activity.sffb == '0'"}],staticClass:"padding-sm",staticStyle:{"text-align":"center"}},[e("v-uni-button",{staticClass:"cu-btn bg-blue",staticStyle:{"margin-top":"60upx"},on:{click:function(i){i=t.$handleEvent(i),t.createCode(i)}}},[t._v("发布本次活动并生成二维码")])],1),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"1"==t.user.js&&"1"==t.activity.sffb&&t.curTime>t.strTime&&t.curTime<t.endTime,expression:"user.js == '1' && activity.sffb == '1' && curTime > strTime &&  curTime < endTime"}],staticClass:"padding-sm",staticStyle:{"text-align":"center"}},[e("v-uni-button",{staticClass:"cu-btn bg-blue",on:{click:function(i){i=t.$handleEvent(i),t.updateFbzt(2)}}},[t._v("提前结束活动")])],1),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"0"==t.activity.tpzt&&"1"==t.activity.sffb&&t.curTime>t.strTime&&t.curTime<t.endTime&&!t.saved,expression:"activity.tpzt == '0' && activity.sffb=='1' && curTime > strTime && curTime < endTime && !saved"}],staticStyle:{"text-align":"center"}},[e("v-uni-button",{staticClass:"cu-btn bg-blue shadow-blur",on:{click:function(i){i=t.$handleEvent(i),t.saveRes(i)}}},[t._v("保存我的投票")])],1),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"1"==t.user.js&&"1"==t.activity.sffb,expression:"user.js == '1' && activity.sffb == '1'"}],staticClass:"padding-sm",staticStyle:{"text-align":"center"}},[e("v-uni-button",{staticClass:"cu-btn bg-blue",on:{click:function(i){i=t.$handleEvent(i),t.gotoCodePage(i)}}},[t._v("查看活动二维码")])],1)],1)],2),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"2"==t.activity.sffb,expression:"activity.sffb == '2'"}],staticClass:"padding",staticStyle:{"margin-top":"50upx"}},[e("v-uni-view",{staticClass:"padding-sm",staticStyle:{"text-align":"center"}},[e("v-uni-button",{staticClass:"cu-btn bg-blue",on:{click:function(i){i=t.$handleEvent(i),t.gotoCountPage(i)}}},[t._v("查看活动统计结果")])],1)],1)],1)],1)},a=[];e.d(i,"a",function(){return s}),e.d(i,"b",function(){return a})},ce8e:function(t,i,e){i=t.exports=e("2350")(!1),i.push([t.i,'@charset "UTF-8";\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.vote-wrapper[data-v-d1790158]{padding:20px %?30?%;position:relative}.vote-wrapper .vote-tt[data-v-d1790158]{font-size:14px;color:#333;line-height:2}.vote-wrapper .vote-tt .vote-subtt[data-v-d1790158]{color:#666}.scroll-wrapper[data-v-d1790158]{width:100%;white-space:nowrap}.scroll-wrapper .scroll-view-item[data-v-d1790158]{width:100%;height:auto;display:inline-block}.scroll-wrapper .scroll-view-item .item-block[data-v-d1790158]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start}.scroll-wrapper .scroll-view-item .item-block .item-td uni-label[data-v-d1790158]{padding:%?10?%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;width:100%;white-space:normal}.scroll-wrapper .scroll-view-item .item-block .item-td uni-label .label-text[data-v-d1790158]{padding-left:%?20?%;display:inline-block;width:%?550?%}.scroll-wrapper .scroll-view-item .item-block .item-td[data-v-d1790158]{width:100%}.scroll-wrapper .scroll-view-item .item-block .item-td .detail[data-v-d1790158]{border:1px solid #eee;color:#888;border-radius:%?10?%;padding:%?0?% %?10?%;text-align:center;display:inline-block;font-size:12px;float:right;margin-right:%?20?%}.pages[data-v-d1790158]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}',""])},e678:function(t,i,e){var s=e("ce8e");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var a=e("4f06").default;a("91b52648",s,!0,{sourceMap:!1,shadowMode:!1})}}]);