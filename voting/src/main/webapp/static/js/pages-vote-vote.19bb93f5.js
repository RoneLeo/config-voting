(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-vote-vote"],{"17b5":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(i("7e6b"));function a(t){return t&&t.__esModule?t:{default:t}}var n={data:function(){return{loginFormShow:!1,hdid:null,user:{},myJson:s.default,activity:{},isBack:!1,current:1,curTime:"",strTime:"",endTime:"",res:[],inputRes:[],saved:!1}},mounted:function(){},onLoad:function(t){this.hdid=t.hdid,this.user=this.getGlobalUser()||{},getCurrentPages().length>1&&(this.isBack=!0),this.getLogined()||(this.loginFormShow=!0)},onShow:function(){this.user=this.getGlobalUser()||{},(this.getLogined()||this.hdid)&&this.getData()},methods:{loginHide:function(){this.loginFormShow=!1,(this.getLogined()||this.hdid)&&this.getData()},inputChange:function(t){var e=t.currentTarget.dataset,i=e.index,s=e.opid,a=t.target.value;this.inputRes[i]={oid:s,pid:this.user.id,qid:this.activity.votelist[i].id,bz:a}},createCode:function(){var t=this;this.$api.post("/theme/updateFbzt",{id:this.hdid,fbzt:1}).then(function(e){200==e.resCode?(uni.showToast({title:"发布成功！",icon:"none"}),t.gotoCodePage()):100==e.resCode&&(t.loginFormShow=!0)})},gotoCountPage:function(){uni.navigateTo({url:"../../pages/voteCount/voteCount?hdid="+this.hdid})},gotoCodePage:function(){uni.navigateTo({url:"../../pages/code/code?lx=vote&id="+this.hdid+"&title="+this.activity.bt+"&kssj="+this.activity.kssj.substring(0,11)+"&jssj="+this.activity.jssj.substring(0,11)})},getData:function(){var t=this;uni.showLoading({title:"加载中"}),this.$api.post("/theme/findAllInfoById",{id:this.hdid}).then(function(e){uni.hideLoading(),200==e.resCode?(t.activity=e.data,t.res=new Array(t.activity.votelist.length),t.inputRes=new Array(t.activity.votelist.length),t.curTime=(new Date).getTime(),t.strTime=new Date(Date.parse(t.activity.kssj.replace(/-/g,"/"))).getTime(),t.endTime=new Date(Date.parse(t.activity.jssj.replace(/-/g,"/"))).getTime()):100==e.resCode&&(t.loginFormShow=!0)})},updateFbzt:function(t){var e=this;this.$api.post("/theme/updateFbzt",{id:this.hdid,fbzt:t}).then(function(t){200==t.resCode?(uni.showToast({title:"操作成功！",icon:"none"}),uni.navigateBack()):100==t.resCode&&(e.loginFormShow=!0)})},saveRes:function(){var t=this,e=this.activity.votelist.length;if("2"!=this.activity.votelist[e-1].tplx||!this.activity.votelist[e-1].zxs||this.res[e-1].length>=this.activity.votelist[e-1].zxs&&this.res[e-1].length<=this.activity.votelist[e-1].zds){for(var i=[],s=0,a=this.res.length;s<a;s++)if(this.res[s]&&this.res[s].length)for(var n=0;n<this.res[s].length;n++)this.res[s][n]&&this.inputRes[s]&&this.res[s][n].oid==this.inputRes[s].oid&&this.res[s][n].pid==this.inputRes[s].pid&&this.res[s][n].qid==this.inputRes[s].qid?i.push(this.inputRes[s]):i.push(this.res[s][n]);this.$api.post("/voting/vote",JSON.stringify(i)).then(function(e){200==e.resCode?(uni.showToast({title:"保存成功！",icon:"none"}),t.saved=!0,uni.navigateBack()):100==e.resCode&&(t.loginFormShow=!0)})}else uni.showToast({title:"请确认你的选择是否符合题目要求",icon:"none"})},radioChange:function(t){var e=this,i="radio"+t;this.res[t]=[];var s=this.$refs[i][0].radioList.length&&this.$refs[i][0].radioList;s.forEach(function(i){if(i.radioChecked){var s={pid:e.user.id,qid:e.activity.votelist[t].id,oid:i.radioValue,bz:""};e.res[t].push(s)}})},checkboxChange:function(t){var e=this,i="checkbox"+t;this.res[t]=[];var s=this.$refs[i][0].checkboxList.length&&this.$refs[i][0].checkboxList;s.forEach(function(i){if(i.checkboxChecked){var s={pid:e.user.id,qid:e.activity.votelist[t].id,oid:i.checkboxValue,bz:""};e.res[t].push(s)}})},lastOne:function(){this.current>1&&this.current--},nextOne:function(){var t=this.current-1;this.current<this.activity.votelist.length&&("2"==this.activity.votelist[t].tplx?this.activity.votelist[t].zxs?this.res[t]&&this.res[t].length&&this.res[t].length>=this.activity.votelist[t].zxs&&this.res[t].length<=this.activity.votelist[t].zds?this.current++:uni.showToast({title:"请确认你的选择是否符合题目要求",icon:"none"}):this.current++:this.res[t]&&this.res[t].length&&1==this.res[t].length?this.current++:uni.showToast({title:"请确认你的选择是否符合题目要求",icon:"none"}))},gotoVoteTitle:function(){uni.navigateTo({url:"../../pages/voteTitle/voteTitle"})},SwitchB:function(t){this.switchB=t.detail.value},startDateChange:function(t){this.startDate=t.detail.value},endDateChange:function(t){this.endDate=t.detail.value}}};e.default=n},"2faf":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"page"},[i("login",{attrs:{loginFormShow:t.loginFormShow},on:{hide:function(e){e=t.$handleEvent(e),t.loginHide(e)}}}),i("cu-custom",{directives:[{name:"show",rawName:"v-show",value:t.isBack,expression:"isBack"}],attrs:{bgColor:"bg-blue",isBack:t.isBack}},[i("template",{staticStyle:{width:"calc(100% - 100px)"},attrs:{slot:"content"},slot:"content"},[t._v(t._s(t.activity&&t.activity.bt))])],2),i("v-uni-view",{staticClass:"vote-wrapper padding"},[i("v-uni-image",{directives:[{name:"show",rawName:"v-show",value:"2"==t.activity.sffb,expression:"activity.sffb == '2'"}],staticStyle:{width:"150upx",height:"150upx",position:"absolute",left:"480upx",top:"140upx"},attrs:{src:"../../static/img/end.png",mode:""}}),i("v-uni-view",{staticClass:"vote-tt title",staticStyle:{"font-size":"18px"}},[t._v(t._s(t.activity.bt)),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"1"==t.activity.tpzt||t.saved,expression:"activity.tpzt == '1' || saved"}],staticClass:"cu-tag line-orange radius",staticStyle:{"margin-left":"20upx"}},[t._v("已完成投票")])],1),i("v-uni-view",{staticClass:"vote-tt",staticStyle:{"margin-top":"40upx"}},[t._v("活动状态："),i("v-uni-text",{staticClass:"vote-subtt"},[t._v(t._s("0"==t.activity.sffb?"尚未发布":"1"==t.activity.sffb?"已发布":"活动已结束"))])],1),i("v-uni-view",{staticClass:"vote-tt"},[t._v("投票期限："),i("v-uni-text",{staticClass:"vote-subtt"},[t._v(t._s(t.activity.kssj&&t.activity.kssj.substring(0,11))+" 至 "+t._s(t.activity.kssj&&t.activity.jssj.substring(0,11)))])],1),i("v-uni-view",{staticClass:"vote-tt"},[t._v("投票说明："),i("v-uni-text",{staticClass:"vote-subtt"},[t._v(t._s(t.activity.nr))])],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"2"!=t.activity.sffb,expression:"activity.sffb != '2'"}],staticClass:"scroll-wrapper",staticStyle:{padding:"30upx 0"}},[t._l(t.activity.votelist,function(e,s){return i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.current==s+1,expression:"current == (index + 1)"}],staticClass:"scroll-view-item",attrs:{id:"item"+(s+1)}},[i("v-uni-view",{staticClass:"item-block"},[i("v-uni-view",{staticClass:"item-tt"},[t._v(t._s(s+1)+". "+t._s(e.bt)),i("v-uni-text",[t._v("（"+t._s(t.myJson.vote[e.tplx])),i("v-uni-text",{directives:[{name:"show",rawName:"v-show",value:"2"==e.tplx,expression:"vote.tplx == '2'"}]},[t._v("，选择"+t._s(e.zxs)+"~"+t._s(e.zds))]),t._v("）")],1)],1),i("v-uni-view",{staticClass:"item-td padding-sm"},[i("v-uni-radio-group",{directives:[{name:"show",rawName:"v-show",value:"1"==e.tplx,expression:"vote.tplx == '1'"}],ref:"radio"+s,refInFor:!0,staticStyle:{"margin-left":"30upx",width:"90%"},on:{change:function(e){e=t.$handleEvent(e),t.radioChange(s)}}},t._l(e.volist,function(e,a){return i("v-uni-label",{key:a},[i("v-uni-radio",{attrs:{value:e.id+""}}),i("v-uni-view",{staticClass:"label-text"},[i("v-uni-text",{directives:[{name:"show",rawName:"v-show",value:1==e.xxlx||3==e.xxlx,expression:"opt.xxlx == 1 || opt.xxlx == 3"}]},[t._v(t._s(e.xxmc))]),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:2==e.xxlx,expression:"opt.xxlx == 2"}]},[i("v-uni-image",{staticStyle:{width:"200upx",height:"150upx"},attrs:{src:e.xxmc,mode:""}})],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:4==e.xxlx,expression:"opt.xxlx == 4"}],staticStyle:{border:"1px solid #e1e1e1","border-radius":"10upx"}},[i("v-uni-input",{ref:"input"+s,refInFor:!0,staticStyle:{"padding-left":"20upx"},attrs:{"data-index":s,"data-opid":e.id,placeholder:"请填写"},on:{input:function(e){e=t.$handleEvent(e),t.inputChange(e)}}})],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:""!=e.xxnr&&null!=e.xxnr,expression:"opt.xxnr!=''&&opt.xxnr!=null"}],staticClass:"detail"},[t._v("详情")])],1)],1)})),i("v-uni-checkbox-group",{directives:[{name:"show",rawName:"v-show",value:"2"==e.tplx,expression:"vote.tplx == '2'"}],ref:"checkbox"+s,refInFor:!0,staticStyle:{"margin-left":"30upx",width:"90%"},on:{change:function(e){e=t.$handleEvent(e),t.checkboxChange(s)}}},t._l(e.volist,function(e,a){return i("v-uni-label",{key:a},[i("v-uni-checkbox",{attrs:{value:e.id+""}}),i("v-uni-view",{staticClass:"label-text"},[i("v-uni-text",{directives:[{name:"show",rawName:"v-show",value:1==e.xxlx||3==e.xxlx,expression:"opt.xxlx == 1 || opt.xxlx == 3"}]},[t._v(t._s(e.xxmc))]),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:2==e.xxlx,expression:"opt.xxlx == 2"}]},[i("v-uni-image",{staticStyle:{width:"200upx",height:"150upx"},attrs:{src:e.xxmc,mode:""}})],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:4==e.xxlx,expression:"opt.xxlx == 4"}],staticStyle:{border:"1px solid #e1e1e1","border-radius":"10upx"}},[i("v-uni-input",{ref:"input"+s,refInFor:!0,staticStyle:{"padding-left":"20upx"},attrs:{"data-index":s,"data-opid":e.id,placeholder:"请填写"},on:{input:function(e){e=t.$handleEvent(e),t.inputChange(e)}}})],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:""!=e.xxnr&&null!=e.xxnr,expression:"opt.xxnr!=''&&opt.xxnr!=null"}],staticClass:"detail"},[t._v("详情")])],1)],1)}))],1)],1)],1)}),i("v-uni-view",{staticClass:"pages padding justify-center"},[i("v-uni-button",{staticClass:"cu-btn bg-blue",on:{click:function(e){e=t.$handleEvent(e),t.lastOne(e)}}},[t._v("上一题")]),i("v-uni-text",{staticStyle:{width:"130upx","text-align":"center",display:"inline-block","align-self":"center"}},[t._v(t._s(t.current)+" / "+t._s(t.activity.votelist&&t.activity.votelist.length))]),i("v-uni-button",{staticClass:"cu-btn bg-blue",on:{click:function(e){e=t.$handleEvent(e),t.nextOne(e)}}},[t._v("下一题")])],1),i("v-uni-view",{staticStyle:{"margin-top":"50upx"}},[i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"1"==t.user.js&&"0"==t.activity.sffb,expression:"user.js == '1' && activity.sffb == '0'"}],staticClass:"padding-sm",staticStyle:{"text-align":"center"}},[i("v-uni-button",{staticClass:"cu-btn bg-blue",staticStyle:{"margin-top":"60upx"},on:{click:function(e){e=t.$handleEvent(e),t.createCode(e)}}},[t._v("发布本次活动并生成二维码")])],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"1"==t.user.js&&"1"==t.activity.sffb&&t.curTime>t.strTime&&t.curTime<t.endTime,expression:"user.js == '1' && activity.sffb == '1' && curTime > strTime &&  curTime < endTime"}],staticClass:"padding-sm",staticStyle:{"text-align":"center"}},[i("v-uni-button",{staticClass:"cu-btn bg-blue",on:{click:function(e){e=t.$handleEvent(e),t.updateFbzt(2)}}},[t._v("提前结束活动")])],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"0"==t.activity.tpzt&&"1"==t.activity.sffb&&t.curTime>t.strTime&&t.curTime<t.endTime&&!t.saved,expression:"activity.tpzt == '0' && activity.sffb=='1' && curTime > strTime && curTime < endTime && !saved"}],staticStyle:{"text-align":"center"}},[i("v-uni-button",{staticClass:"cu-btn bg-blue shadow-blur",on:{click:function(e){e=t.$handleEvent(e),t.saveRes(e)}}},[t._v("保存我的投票")])],1),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"1"==t.user.js&&"1"==t.activity.sffb,expression:"user.js == '1' && activity.sffb == '1'"}],staticClass:"padding-sm",staticStyle:{"text-align":"center"}},[i("v-uni-button",{staticClass:"cu-btn bg-blue",on:{click:function(e){e=t.$handleEvent(e),t.gotoCodePage(e)}}},[t._v("查看活动二维码")])],1)],1)],2),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"2"==t.activity.sffb,expression:"activity.sffb == '2'"}],staticClass:"padding",staticStyle:{"margin-top":"50upx"}},[i("v-uni-view",{staticClass:"padding-sm",staticStyle:{"text-align":"center"}},[i("v-uni-button",{staticClass:"cu-btn bg-blue",on:{click:function(e){e=t.$handleEvent(e),t.gotoCountPage(e)}}},[t._v("查看活动统计结果")])],1)],1)],1)],1)},a=[];i.d(e,"a",function(){return s}),i.d(e,"b",function(){return a})},3843:function(t,e,i){"use strict";var s=i("f978"),a=i.n(s);a.a},6719:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,'@charset "UTF-8";\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.vote-wrapper[data-v-688e7c50]{padding:20px %?30?%;position:relative}.vote-wrapper .vote-tt[data-v-688e7c50]{font-size:14px;color:#333;line-height:2}.vote-wrapper .vote-tt .vote-subtt[data-v-688e7c50]{color:#666}.scroll-wrapper[data-v-688e7c50]{width:100%;white-space:nowrap}.scroll-wrapper .scroll-view-item[data-v-688e7c50]{width:100%;height:auto;display:inline-block}.scroll-wrapper .scroll-view-item .item-block[data-v-688e7c50]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start}.scroll-wrapper .scroll-view-item .item-block .item-td uni-label[data-v-688e7c50]{padding:%?10?%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;width:100%;white-space:normal}.scroll-wrapper .scroll-view-item .item-block .item-td uni-label .label-text[data-v-688e7c50]{padding-left:%?20?%;display:inline-block;width:%?550?%}.scroll-wrapper .scroll-view-item .item-block .item-td[data-v-688e7c50]{width:100%}.scroll-wrapper .scroll-view-item .item-block .item-td .detail[data-v-688e7c50]{border:1px solid #eee;color:#888;border-radius:%?10?%;padding:%?0?% %?10?%;text-align:center;display:inline-block;font-size:12px;float:right;margin-right:%?20?%}.pages[data-v-688e7c50]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}',""])},7279:function(t,e,i){"use strict";i.r(e);var s=i("2faf"),a=i("c81b");for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);i("3843");var o=i("2877"),r=Object(o["a"])(a["default"],s["a"],s["b"],!1,null,"688e7c50",null);e["default"]=r.exports},"7e6b":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={1:"文字",2:"多媒体",3:"数字",4:"其他"},a={1:"单选",2:"多选"},n={voteOpt:s,vote:a};e.default=n},c81b:function(t,e,i){"use strict";i.r(e);var s=i("17b5"),a=i.n(s);for(var n in s)"default"!==n&&function(t){i.d(e,t,function(){return s[t]})}(n);e["default"]=a.a},f978:function(t,e,i){var s=i("6719");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var a=i("4f06").default;a("276f0639",s,!0,{sourceMap:!1,shadowMode:!1})}}]);